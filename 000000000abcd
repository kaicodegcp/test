Safe to Delete
In your debug shell (or directly on host):

bash
Copy
Edit
chroot /host ls -l --time-style=long-iso /etc/docker/certs.d/
chroot /host ls -l --time-style=long-iso /etc/pki/ca-trust/source/anchors/
Look for files with 2025-05-30 timestamps ‚Äî and remove them:

bash
Copy
Edit
chroot /host rm -f /etc/docker/certs.d/sd-wv58-kflz.nam.nsroot.net:5000/ca.crt
chroot /host rm -f /etc/pki/ca-trust/source/anchors/domain.crt
‚úÖ Then Recreate Correct Cert Path
If you‚Äôve validated your current working domain.crt, then:

bash
Copy
Edit
mkdir -p /host/etc/docker/certs.d/sd-wv58-kflz.nam.nsroot.net:5000
cp /host/etc/pki/ca-trust/source/anchors/domain.crt /host/etc/docker/certs.d/sd-wv58-kflz.nam.nsroot.net:5000/ca.crt
üîÑ Refresh Trust
bash
Copy
Edit
chroot /host update-ca-trust extract
chroot /host systemctl restart crio
üßº Optional: Remove wrong configmaps or secrets created earlier
If the May 30 cert was stored in ConfigMap or Secret:

bash
Copy
Edit
oc delete configmap docker-registry-cert -n openshift-config
oc delete secret my-registry-secret -n nacho







==================


Fix Now
Re-upload the correct working domain.crt to the host from your known location (e.g. /opt/registry/certs/domain.crt on bdgtr076x11t1):

bash
Copy
Edit
oc debug node/dfgtr040x12h5.nam.nsroot.net
Inside debug shell:

bash
Copy
Edit
chroot /host mkdir -p /etc/pki/ca-trust/source/anchors
cp /host/opt/registry/certs/domain.crt /host/etc/pki/ca-trust/source/anchors/domain.crt
Then copy to Docker certs path again:

bash
Copy
Edit
mkdir -p /host/etc/docker/certs.d/sd-wv58-kflz.nam.nsroot.net:5000
cp /host/etc/pki/ca-trust/source/anchors/domain.crt /host/etc/docker/certs.d/sd-wv58-kflz.nam.nsroot.net:5000/ca.crt
Update trust and restart CRI-O:

bash
Copy
Edit
chroot /host update-ca-trust extract
chroot /host systemctl restart crio
Exit debug pod and retry vault

bash
Copy
Edit
exit
oc delete pod vault-test -n nacho
‚úÖ Next Step
Once that‚Äôs done and pod is recreated, run:




============================================

To patch the default service account in your namespace (e.g., nacho) to use your my-registry-secret for image pulls, run this command:

bash
Copy
Edit
oc patch serviceaccount default \
  -p '{"imagePullSecrets": [{"name": "my-registry-secret"}]}' \
  -n nacho
üîÅ If you've already patched it once but want to ensure it's the only secret used (clean slate), run this version:

bash
Copy
Edit
oc patch serviceaccount default \
  --type='merge' \
  -p '{"imagePullSecrets": [{"name": "my-registry-secret"}]}' \
  -n nacho
‚úÖ To Verify Afterward:
bash
Copy
Edit
oc get serviceaccount default -n nacho -o yaml | grep imagePullSecrets -A2
You should see:

yaml
Copy
Edit
imagePullSecrets:
- name: my-registry-secret
bash
Copy
Edit
oc get pods -n nacho -w
