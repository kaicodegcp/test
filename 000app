oc run test-cer-a \
  --image=sd-wv58-kflz.nam.nsroot.net:5000/cdp-private/cloudera/redhat8/postgresql-10:1-215 \
  --restart=Never -it --rm -n xyz

oc run test-cer-a \
  --image=sd-wv58-kflz.nam.nsroot.net:5000/cdp-private/cloudera_thirdparty/rhel8/postgresql-10:1-215 \
  --restart=Never -it --rm -n xyz


oc run test-cer-a \
  --image=sd-wv58-kflz.nam.nsroot.net:5000/cdp-private/cloudera/redhat8/postgresql-10:1-215 \
  --env=POSTGRESQL_USER=admin \
  --env=POSTGRESQL_PASSWORD=admin123 \
  --env=POSTGRESQL_DATABASE=testdb \
  --restart=Never -it --rm -n xyz

--env=POSTGRESQL_MAX_CONNECTIONS=200
--env=POSTGRESQL_SHARED_BUFFERS=64MB

Step 1: Export the Secret or ConfigMap from xyz Cluster
Export secret to file:

bash
Copy
Edit
oc get secret cdp-private-installer-docker-pull-secret -n xyz -o yaml > docker-pull-secret.yaml
Export configmap (e.g., truststore):

bash
Copy
Edit
oc get configmap cdp-pvc-truststore -n xyz -o yaml > truststore-configmap.yaml
ðŸ”¹ Step 2: Edit the YAML (very important)
Open each file and change the namespace from xyz to nacho-cds.

For example, in docker-pull-secret.yaml:

yaml
Copy
Edit
metadata:
  name: cdp-private-installer-docker-pull-secret
  namespace: nacho-cds    # <-- CHANGE THIS
Do the same for the ConfigMap YAML file.

ðŸ”¹ Step 3: Apply to nacho-cds cluster
Now switch your oc CLI to the nacho-cds cluster:

bash
Copy
Edit
export KUBECONFIG=/path/to/nacho-cds-kubeconfig
oc config use-context <your-nacho-cds-context>
Apply the files:

bash
Copy
Edit
oc apply -f docker-pull-secret.yaml
oc apply -f truststore-configmap.yaml
ðŸ”¹ Step 4: Link the Secret to Default SA in nacho-cds
bash
Copy
Edit
oc secrets link default cdp-private-installer-docker-pull-secret --for=pull -n nacho-cds
âœ… Now retry pod or CDS install

Edit
oc delete pod <pod-name> -n nacho-cds
Or re-run:

bash
Copy
Edit
oc run test-cer-a \
  --image=sd-wv58-kflz.nam.nsroot.net:5000/cdp-private/cloudera/redhat8/postgresql-10:1-215 \
  --env=POSTGRESQL_USER=admin \
  --env=POSTGRESQL_PASSWORD=admin123 \
  --env=POSTGRESQL_DATABASE=testdb \
  --restart=Never -it -n nacho-cds




=======================================================


Step-by-Step Fix
âœ… STEP 1: Extract the domain certificate from xyz cluster
On your xyz cluster (where it works):

bash
Copy
Edit
oc get configmap openshift-service-ca.crt -n xyz -o yaml > service-ca-xyz.yaml
OR if you installed your own domain cert manually to trust the Docker registry, then find it (like domain.crt, registry.crt, etc.)

If youâ€™re not sure, check this path on xyz admin host:

bash
Copy
Edit
cat /etc/pki/ca-trust/source/anchors/domain.crt
Then copy that file securely to your nacho-cds admin node, e.g.:

bash
Copy
Edit
scp /etc/pki/ca-trust/source/anchors/domain.crt root@nacho-cds-admin:/tmp/
âœ… STEP 2: Create the cert ConfigMap in nacho-cds
Now, on the nacho-cds cluster:

bash
Copy
Edit
oc create configmap registry-ca-cert \
  --from-file=sd-wv58-kflz.nam.nsroot.net.crt=/tmp/domain.crt \
  -n openshift-config
Make sure the filename matches the registry hostname, as expected by OpenShift.

âœ… STEP 3: Patch the OpenShift proxy to trust it
bash
Copy
Edit
oc patch proxy/cluster \
  --type=merge \
  -p '{"spec":{"trustedCA":{"name":"registry-ca-cert"}}}'
âœ… STEP 4: Allow time to propagate or reboot nodes (if urgent)
You can wait a few minutes OR restart nodes (optional but faster):

bash
Copy
Edit
oc debug node/<node-name>
chroot /host
systemctl restart crio
âœ… STEP 5: Recreate the pod to test pull
bash
Copy
Edit
oc delete pod test-cer-a -n nacho-cds

oc run test-cer-a \
  --image=sd-wv58-kflz.nam.nsroot.net:5000/cdp-private/cloudera/redhat8/postgresql-10:1-215 \
  --env=POSTGRESQL_USER=admin \
  --env=POSTGRESQL_PASSWORD=admin123 \
  --env=POSTGRESQL_DATABASE=testdb \
  --restart=Never -it -n nacho-cds
